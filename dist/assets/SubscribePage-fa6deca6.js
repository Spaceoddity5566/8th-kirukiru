var t=Object.defineProperty,e=Object.getOwnPropertySymbols,a=Object.prototype.hasOwnProperty,r=Object.prototype.propertyIsEnumerable,s=(e,a,r)=>a in e?t(e,a,{enumerable:!0,configurable:!0,writable:!0,value:r}):e[a]=r;import{_ as o,L as l,Q as n}from"./index-4165e28f.js";import{m as i,ai as d,o as u,c,d as h,s as m,t as p}from"./vendor-358810ac.js";const b={name:"SubscribePage",props:{authorId:{type:String,default:""}},data:()=>({authorPlan:null,payType:"WEBATM",payData:[],tradeInfoValue:"",tradeShaValue:"",isPaying:!1}),computed:((t,o)=>{for(var l in o||(o={}))a.call(o,l)&&s(t,l,o[l]);if(e)for(var l of e(o))r.call(o,l)&&s(t,l,o[l]);return t})({},i(["userSubscribeList"])),created(){this.getAuthorPlanHandler()},methods:{getAuthorPlanHandler(){l(this.authorId).then((t=>{t.data.success?this.authorPlan=t.data.data:this.$notify({group:"error",title:"取得方案內容失敗"})})).catch((t=>{}))},paySubscribeHandler(){if(this.checkSub(this.authorId)||this.isPaying)return;this.isPaying=!0,this.$store.commit("SHOW_OVERLAY_LOADING");const t={main:this.authorId,payType:this.payType,returnUrl:`${location.origin}/#/author/${this.authorId}`};n(t).then((t=>{t.data.Status?(this.tradeInfoValue=t.data.PayData.find((t=>"TradeInfo"===t.Key)).Value,this.tradeShaValue=t.data.PayData.find((t=>"TradeSha"===t.Key)).Value,this.$refs.tradeInfo.value=this.tradeInfoValue,this.$refs.tradeSha.value=this.tradeShaValue,this.$refs.subscribeSubmit.submit()):(this.$notify({group:"error",title:"連接失敗"}),this.isPaying=!1,this.$store.commit("HIDE_OVERLAY_LOADING"))})).catch((t=>{}))},checkSub(t){return this.userSubscribeList.some((e=>e.Author===t))},formatThousand:t=>String(t).replace(/\B(?<!\.\d*)(?=(\d{3})+(?!\d))/g,",")}},f={class:"px-4 pt-8 pb-11 mx-auto max-w-[816px] min-h-[calc(100vh-56px-64px)] md:px-0 md:pt-16"},y={class:"mx-auto max-w-[600px] rounded-2xl border-t-8 border-t-myYellow shadow-md md:rounded-t-none md:rounded-b-2xl md:border md:border-myBrown"},x=h("div",{class:"hidden h-4 bg-myYellow md:block"},null,-1),v={class:"p-8 md:py-10 md:px-16"},g={class:"flex gap-4 items-center py-4 border-b border-myBrown"},w={class:"overflow-hidden shrink-0 w-16 h-16 rounded-full"},S={class:"object-cover object-center w-full h-full rounded-lg load",alt:""},P={class:"text-xl text-myBrown"},I={class:"py-8 mb-4"},O={class:"text-sm text-black/80 whitespace-pre-wrap"},k={class:"flex flex-col gap-8 justify-between items-center md:flex-row"},V={class:"flex relative flex-col items-center text-myBrown md:items-start"},T=h("span",{class:"absolute -top-0.5 py-1 px-2 text-xs font-bold text-white bg-red-500 rounded-lg -translate-y-full md:left-0"},"50% OFF",-1),$={class:"text-3xl font-bold"},j=h("p",{class:"text-xs"}," 每月自動扣款，僅限信用卡支付 ",-1),A={class:"grow w-full md:w-auto"},B=["disabled"],D={ref:"subscribeSubmit",class:"hidden",name:"form",action:"https://ccore.spgateway.com/MPG/mpg_gateway",method:"post"},H=h("input",{name:"MerchantID",value:"MS132153993"},null,-1),L={ref:"tradeInfo",name:"TradeInfo"},_={ref:"tradeSha",name:"TradeSha"},E=h("input",{name:"Version",value:"1.5"},null,-1),M=h("input",{type:"submit",value:"Submit"},null,-1);var Y=o(b,[["render",function(t,e,a,r,s,o){var l,n,i,b;const Y=d("src");return u(),c("div",f,[h("div",y,[x,h("div",v,[h("div",g,[h("div",w,[m(h("img",S,null,512),[[Y,`https://kirukiru.rocket-coding.com/Pic/${null==(l=s.authorPlan)?void 0:l.authorPic}`]])]),h("h2",P,p(null==(n=s.authorPlan)?void 0:n.author),1)]),h("div",I,[h("p",O,p(null==(i=s.authorPlan)?void 0:i.info),1)]),h("div",k,[h("div",V,[T,h("p",$,p(o.formatThousand(null==(b=s.authorPlan)?void 0:b.amount))+"元 / 月 ",1),j]),h("div",A,[h("button",{type:"button",class:"w-full userPageButton",disabled:o.checkSub(a.authorId),onClick:e[0]||(e[0]=(...t)=>o.paySubscribeHandler&&o.paySubscribeHandler(...t))},p(o.checkSub(a.authorId)?"您已訂閱該作者":"確認訂閱"),9,B)])])])]),h("form",D,[H,h("input",L,null,512),h("input",_,null,512),E,M],512)])}]]);export{Y as default};
